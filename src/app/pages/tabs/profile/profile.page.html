<ion-header>
  <div class="auth-banner small">
    <h3 class="title">Profile</h3>
  </div>
  <div class="sub-header">
    <div class="user-item">
      <div class="user-name">
        <div class="img-wrapper">
          <div class="default-img">
            {{user.fullname.split(' ')[0][0]}}{{user.fullname.split(' ')[1][0]}}
          </div>
        </div>
        <div class="name">
          <h3>{{ user.fullname }}</h3>
          <p>{{user.username}}</p>
        </div>
      </div>
      <div class="round-small-button" (click)="goToEditProfile()">View Profile</div>
    </div>
  </div>
</ion-header>

<ion-content [fullscreen]="true" class="page-content">
  <div class="actions">
    <div class="action" (click)="goToBeneficiariesPage()">
      <div class="action-name">
        <div class="round-button">
          <ion-icon
            [src]="'assets/icon/v2-icons/round-btns/beneficiary.svg'"
          ></ion-icon>
        </div>
        Beneficiaries
      </div>
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div class="action" (click)="openAccountManagerModal()">
      <div class="action-name">
        <div class="round-button">
          <ion-icon
            [src]="'assets/icon/v2-icons/round-btns/user.svg'"
          ></ion-icon>
        </div>
        Account Manager
      </div>
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div class="action" (click)="goToNextOfKin()">
      <div class="action-name">
        <div class="round-button">
          <ion-icon
            [src]="'assets/icon/v2-icons/round-btns/heart.svg'"
          ></ion-icon>
        </div>
        Next of Kin
      </div>
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div class="action">
      <div class="action-name">
        <div class="round-button">
          <ion-icon
            [src]="'assets/icon/v2-icons/round-btns/chat.svg'"
          ></ion-icon>
        </div>
        Support
      </div>
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div class="action" (click)="goToChangeArchivePage()">
      <div class="action-name">
        <div class="round-button">
          <ion-icon
            [src]="'assets/icon/v2-icons/round-btns/archive.svg'"
          ></ion-icon>
        </div>
        Archive
      </div>
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div class="action" (click)="goToChangePasswordPage()">
      <div class="action-name">
        <div class="round-button">
          <ion-icon
            [src]="'assets/icon/v2-icons/round-btns/change-pass.svg'"
          ></ion-icon>
        </div>
        Change Password
      </div>
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div class="action" (click)="openSetPinModal('change')">
      <div class="action-name">
        <div class="round-button">
          <ion-icon
            [src]="'assets/icon/v2-icons/round-btns/change-pin.svg'"
          ></ion-icon>
        </div>
        Change PIN
      </div>
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div class="action" (click)="goToSettings()">
      <div class="action-name">
        <div class="round-button">
          <ion-icon
            [src]="'assets/icon/v2-icons/round-btns/settings.svg'"
          ></ion-icon>
        </div>
        Settings
      </div>
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
  </div>

  <div class="actions bottom">
    <h3 class="about-head">About Kwakol</h3>
    <div class="action" (click)="goToLinks('https://www.kwakol.com')">
      Visit our Website
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div
      class="action"
      (click)="goToLinks('https://www.kwakolmarkets.com/faqs')"
    >
      FAQs
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
    <div
      class="action"
      (click)="goToLinks('https://www.kwakolmarkets.com/terms-and-conditions')"
    >
      Terms and Conditions
      <ion-icon class="arrow" src="assets/icon/arrow-forward.svg"></ion-icon>
    </div>
  </div>

  <ion-button
    class="kwakol-btn ion-text-uppercase btn-bottom"
    type="button"
    (click)="logOut()"
  >
    Log Out
  </ion-button>


  <!-- Account Manager modal -->
  <ion-modal
    #accountManagerModal
    [initialBreakpoint]="0.18"
    [breakpoints]="[0, 0.18]"
    class="kwakol-modal-bottom-drawer2"
    handle="true"
  >
    <ng-template>
      <ion-content>
        <!-- <div class="round-button">
          <ion-icon src="assets/icon/padlock.svg"></ion-icon>
        </div> -->
        <h3>Account Manager</h3>

        <div class="item">
          <div>
            <div class="default-img">
              {{accountManager?.fullname.split(' ')[0][0]}}{{accountManager?.fullname.split(' ')[1][0]}}
            </div>
            {{accountManager?.fullname}}
          </div>
          <div>
            <div class="round-button" (click)="openCall()">
              <ion-icon
                [src]="'assets/icon/v2-icons/round-btns/call.svg'"
              ></ion-icon>
            </div>
            <div class="round-button">
              <a href="mailto:{{accountManager?.email}}?subject=Account Enquiry 
              &body=Hello {{accountManager?.fullname.split(' ')[0]}},">
                <ion-icon
                  [src]="'assets/icon/v2-icons/round-btns/mail.svg'"
                ></ion-icon>
              </a>
            </div>
          </div>
        </div>
        
      </ion-content>
    </ng-template>
  </ion-modal>
  <!-- End Account Manager Modal -->

   <!-- Set pin modal -->
   <ion-modal
   #setPinModal
   [initialBreakpoint]="0.85"
   [breakpoints]="[0, 0.25, 0.5, 0.75, 0.85]"
   class="set-pin"
   handle="true"
 >
   <ng-template>
     <ion-content>
       <!-- <div class="handle-wrapper">
         <span class="handle"></span>
       </div> -->

       <div class="header">
         <ion-icon src="assets/icon/set-pin.svg"></ion-icon>
         <h3 *ngIf="showingStatus === 'current'">Change your PIN</h3>
         <h3 *ngIf="showingStatus === 'new'" class="animate__animated animate__zoomIn animate__faster">New PIN</h3>
         <h3 *ngIf="showingStatus === 'confirm'" class="animate__animated animate__zoomIn animate__faster">Confirm PIN</h3>
       </div>

       <p class="p0" *ngIf="showingStatus === 'current'">
        Enter your current PIN
       </p>

       <div class="pin-wrapper">
         <input type="tel" maxlength="1" class="pin-input" [(ngModel)] ="inputs[0]" [ngClass]="{'add-padding': inputs[0] === '*'}"/>
         <input type="tel" maxlength="1" class="pin-input" [(ngModel)] ="inputs[1]" [ngClass]="{'add-padding': inputs[1] === '*'}"/>
         <input type="tel" maxlength="1" class="pin-input" [(ngModel)] ="inputs[2]" [ngClass]="{'add-padding': inputs[2] === '*'}"/>
         <input type="tel" maxlength="1" class="pin-input" [(ngModel)] ="inputs[3]" [ngClass]="{'add-padding': inputs[3] === '*'}"/>
       </div>


       <p class="p1" *ngIf="showingStatus === 'current'" (click)="openOTPModal()">
          Forgot PIN? Reset
       </p>
       
       <app-keypad *ngIf="showingStatus === 'current'" (keypadEmitter)="onKeypadChanged($event)" #appKeypad></app-keypad>
       <app-keypad *ngIf="showingStatus === 'new'" (keypadEmitter)="onKeypadChanged($event)" #appKeypad></app-keypad>
       <app-keypad *ngIf="showingStatus === 'confirm'" (keypadEmitter)="onKeypadChanged($event)" #appKeypad></app-keypad>

       <ion-row class="btn-row">
         <ion-col size="12" class="ion-text-center btn-col">
           <ion-button *ngIf="showingStatus === 'current'" class="kwakol-btn ion-text-uppercase" type="submit" (click)="handlePinSubmit('current')">Change Pin</ion-button>
           <ion-button *ngIf="showingStatus === 'new'" class="kwakol-btn ion-text-uppercase" type="submit" (click)="handlePinSubmit('new')">Confirm</ion-button>
           <ion-button *ngIf="showingStatus === 'confirm'" class="kwakol-btn ion-text-uppercase" type="submit" (click)="handlePinSubmit('confirm')">Done</ion-button>
         </ion-col>
       </ion-row>

     </ion-content>
   </ng-template>
 </ion-modal>
 <!-- End Modal Login with Pin -->


 <!-- Enter OTP Modal -->
 <ion-modal
 #otpModal
 trigger="open-otp-modal"
 [initialBreakpoint]="0.65"
 [breakpoints]="[0, 0.25, 0.5, 0.65, 0.85]"
 class="otp-modal"
 handle="true"
>
 <ng-template>
   <ion-content>
     <div class="round-button">
       <ion-icon src="assets/icon/padlock.svg"></ion-icon>
     </div>
     <h3>Enter Code</h3>
     <p class="p1"> 
       We sent a One-Time-Password (OTP) to your email address.
     </p>

     <div class="otp-wrapper">
       <input type="tel" maxlength="1" class="otp-input" [(ngModel)]="otp1" (ngModelChange)="onOTPInputChange()"/>
       <input type="tel" maxlength="1" class="otp-input" [(ngModel)]="otp2" (ngModelChange)="onOTPInputChange()"/>
       <input type="tel" maxlength="1" class="otp-input" [(ngModel)]="otp3" (ngModelChange)="onOTPInputChange()"/>
       <input type="tel" maxlength="1" class="otp-input" [(ngModel)]="otp4" (ngModelChange)="onOTPInputChange()"/>
       <input type="tel" maxlength="1" class="otp-input" [(ngModel)]="otp5" (ngModelChange)="onOTPInputChange()"/>
       <input type="tel" maxlength="1" class="otp-input" [(ngModel)]="otp6" (ngModelChange)="onOTPInputChange()"/>
     </div>

     <p class="p2">{{resendOTPText}} <span *ngIf="!isResendingOTP">{{pinResendSecs}}s</span></p>

     <ion-row>
       <ion-col size="12" class="ion-text-center btn-col">
         <ion-button
           class="kwakol-btn ion-text-uppercase"
           type="submit"
           (click)="verifyOTP()"
           [disabled]="!otpComplete"
           >Verify</ion-button
         >
       </ion-col>
     </ion-row>
   </ion-content>
 </ng-template>
</ion-modal>
<!-- End Modal OTP -->

</ion-content>
